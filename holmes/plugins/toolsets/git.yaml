toolsets:
  git/core:
    description: "Runs git commands to read repos and create prs"
    docs_url: ""
    icon_url: "https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg"
    tags:
      - core
      
    tools:
      - name: "git_read_file_with_line_numbers"
        description: |
          Reads a specific file from the remote Git repository and prints each line with its corresponding line number.
          Parameters:
          - filepath: The path of the file in the repository to read.
        command: >
          curl -s -H "Authorization: token ${GIT_CREDENTIALS}" 
          "https://api.github.com/repos/${GIT_REPO}/contents/{{ filepath }}" | 
          jq -r '.content' | base64 -d | 
          nl -ba

      - name: "git_list_files"
        description: |
          Lists all files and directories in the remote Git repository (recursively).
        command: >
          curl -s -H "Authorization: token ${GIT_CREDENTIALS}" 
          "https://api.github.com/repos/${GIT_REPO}/git/trees/${GIT_BRANCH}?recursive=1" | 
          jq -r '.tree[] | .path'

      - name: "git_list_open_prs"
        description: |
          Lists all open pull requests (PRs) in the remote Git repository.
          Before creating a new PR, we always check if there is an open PR first.
        command: >
          curl -s -H "Authorization: token ${GIT_CREDENTIALS}" 
          "https://api.github.com/repos/${GIT_REPO}/pulls?state=open" | 
          jq -r '.[] | "\(.number): \(.title) - https://github.com/'"${GIT_REPO}"'/pull/\(.number)"'

      - name: "git_execute_changes"
        description: |
          Executes remote changes in the Git repository and optionally opens a pull request.
          Parameters:
          - line: The line number in the file to modify.
          - filename: The path of the file in the repository to modify.
          - command: The type of change (insert, update, remove).
          - code: Content to insert or replace (leave empty for remove).
          - open_pr: true/false, whether to open a pull request after committing.
          - commit_pr: The title of the commit or PR.
          - dry_run: true/false, whether to simulate the changes and print the resulting content without making remote changes.
          - commit_message: string detailing the message for the commit, Prometheus Alert X was firing on recource Y on X date.
        command: >
          ./remote_git_operations.sh 
          "{{ line }}" 
          "{{ filename }}" 
          "{{ command }}" 
          "{{ code }}" 
          "{{ open_pr }}" 
          "{{ commit_pr }}" 
          "{{ dry_run }}"
          "{{ commit_message }}"